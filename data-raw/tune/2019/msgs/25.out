> 
> # parse arguments
> args <- R.utils::commandArgs(trailingOnly = FALSE, asValues = TRUE)
> index <- as.integer(args$index)
> year <- as.character(args$year)
> nreps <- as.integer(args$nreps)
> seed <- as.integer(args$seed)
> 
> # get number of cores
> wkrs <- length(future::availableWorkers())
> 
> # set seed
> set.seed(seed)
> 
> # read and prepare the cluster features
> fp <- file.path('data-raw', 'features', year)
> clf <-
+   read_features(fp, pattern = 'paris.', recursive = FALSE)
> clf <- prepare_features(
+   clf,
+   feature_map = feature_map,
+   category = c('response', 'bio', 'net'),
+   type = 'list',
+   exclusions = c(
+     'mg2_pairs_count',
+     'mg2_not_pairs_count',
+     'mg2_portion_families_recovered',
+     'cluster_origin',
+     'bocc_origin',
+     'cluster_method',
+     'subcluster_method',
+     'year',
+     'IDs',
+     'go_sig_threshold',
+     'num_new_edges_on_any_node',
+     'HPO_ratio'
+   ),
+   verbose = TRUE
+ )
c('HPO_ratio', 'IDs', 'bocc_origin', 'cluster_method', 'cluster_origin', 'go_sig_threshold', 'max_norm_cell_type_comma_sep_string', 'max_norm_disease_comma_sep_string', 'mg2_not_pairs_count', 'mg2_pairs_count', 'mg2_portion_families_recovered', 'num_new_edges_on_any_node', 'sig_go_enrichment_fdr_corrected_p_vals', 'sig_go_enrichment_p_vals', 'sig_go_enrichment_terms', 'subcluster_method', 'year')

> 
> # prepare grid of parameters
> xgboost_params <- dials::parameters(
+   nrounds = dials::trees(),
+   eta = dials::learn_rate(),
+   gamma = dials::loss_reduction(),
+   dials::tree_depth(),
+   subsample = dials::sample_prop(),
+   rate_drop = dials::dropout(),
+   skip_drop = dials::dropout()
+ )
> xgboost_params <-
+   dials::grid_max_entropy(xgboost_params, size = nreps)
> 
> # tune the dart booster
> dart.param <-
+   list(
+     booster = "dart",
+     objective = "reg:logistic",
+     eval_metric = "rmse",
+     nthread = wkrs,
+     max_depth = xgboost_params$tree_depth[index],
+     eta = xgboost_params$eta[index],
+     gamma = xgboost_params$gamma[index],
+     subsample = xgboost_params$subsample[index],
+     rate_drop = xgboost_params$rate_drop[index],
+     skip_drop = xgboost_params$skip_drop[index]
+   )
> dart.cv <- xgboost::xgb.cv(
+   params = dart.param,
+   nrounds = xgboost_params$nrounds[index],
+   data = as.matrix(clf[, -1]),
+   nfold = 5,
+   label = clf$snowballing_pvalue,
+   early_stopping_rounds = 50
+ )
[1]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
Multiple eval metrics are present. Will use test_rmse for early stopping.
Will train until test_rmse hasn't improved in 50 rounds.

[2]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[3]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[4]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[5]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[6]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[7]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[8]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[9]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[10]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[11]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[12]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[13]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[14]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[15]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[16]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[17]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[18]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[19]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[20]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[21]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[22]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[23]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[24]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[25]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[26]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[27]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[28]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[29]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[30]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[31]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[32]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[33]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[34]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[35]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[36]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[37]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[38]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[39]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[40]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[41]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[42]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[43]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[44]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[45]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[46]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[47]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[48]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[49]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[50]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[51]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[52]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[53]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[54]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[55]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[56]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[57]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[58]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[59]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[60]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[61]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[62]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[63]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[64]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[65]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[66]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[67]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[68]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[69]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[70]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[71]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[72]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[73]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[74]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[75]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[76]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[77]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[78]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[79]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[80]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[81]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[82]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[83]	train-rmse:0.417713+0.001019	test-rmse:0.417692+0.004059 
[84]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[85]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[86]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[87]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[88]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[89]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[90]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[91]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[92]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[93]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[94]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[95]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[96]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[97]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[98]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[99]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[100]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[101]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[102]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[103]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[104]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[105]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[106]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[107]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[108]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[109]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[110]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[111]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[112]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[113]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[114]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[115]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[116]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[117]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[118]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[119]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[120]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[121]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[122]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[123]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[124]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[125]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[126]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[127]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[128]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[129]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[130]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[131]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[132]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[133]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[134]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[135]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[136]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[137]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[138]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[139]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[140]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[141]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[142]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[143]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[144]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[145]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[146]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[147]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[148]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[149]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[150]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[151]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[152]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[153]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[154]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[155]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[156]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[157]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[158]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[159]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[160]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[161]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[162]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[163]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[164]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[165]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[166]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[167]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[168]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[169]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[170]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[171]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[172]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[173]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[174]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[175]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[176]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[177]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[178]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[179]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[180]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[181]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[182]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[183]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[184]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[185]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[186]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[187]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[188]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[189]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[190]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[191]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[192]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[193]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[194]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[195]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[196]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[197]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[198]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[199]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[200]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[201]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[202]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[203]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[204]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[205]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[206]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[207]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[208]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[209]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[210]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[211]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[212]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[213]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[214]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[215]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[216]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[217]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[218]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[219]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[220]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[221]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[222]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[223]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[224]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[225]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[226]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[227]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[228]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[229]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
[230]	train-rmse:0.417713+0.001019	test-rmse:0.417691+0.004059 
> hgrid <-
+   dplyr::bind_cols(xgboost_params[index, ], dart.cv$evaluation_log[dart.cv$best_iteration, ], best_iter = dart.cv$best_iteration)
> 
> # write result
> fname <- file.path('data-raw', 'tune', year, 'array', paste0('tune_', index, '.tsv'))
> readr::write_tsv(hgrid, file = fname)
